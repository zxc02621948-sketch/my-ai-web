# 迷你播放器預設位置調整

> **更新日期：** 2025-10-22  
> **修改：** 增加安全距離，避免播放器太靠邊

---

## 🎯 **問題描述**

**原本的預設位置：**
- 位於右上角
- 距離邊緣只有 16px
- 部分內容可能被切掉或太靠邊

---

## ✅ **解決方案**

### **修改預設位置：**

**Before:**
```javascript
const margin = 16;
const x = Math.max(margin, window.innerWidth - width - margin);
const y = margin;
```

**After:**
```javascript
const margin = 16;
const safeOffset = 60; // ✅ 額外的安全距離
const x = Math.max(margin + safeOffset, window.innerWidth - width - margin - safeOffset);
const y = margin + safeOffset;
```

---

## 📊 **位置對比**

### **原本位置：**

```
螢幕邊緣
│←16px→┌───────────┐
│       │ 播放器     │
│       │           │
│       └───────────┘
```

**問題：**
- ❌ 太靠右邊緣
- ❌ 太靠上邊緣
- ❌ 可能被瀏覽器 UI 遮擋
- ❌ 拖曳時容易碰到邊緣

---

### **調整後位置：**

```
螢幕邊緣
│←76px→┌───────────┐
│       │ 播放器     │
│       │           │
│       └───────────┘
    ↑
   60px
```

**優點：**
- ✅ 距離右邊 76px (16 + 60)
- ✅ 距離上邊 76px (16 + 60)
- ✅ 不會被遮擋
- ✅ 拖曳空間更充裕

---

## 🎨 **視覺示意**

### **桌面版 (1920x1080):**

**原位置：**
```
┌────────────────────────────────────┐
│ 16px             [播]16px          │
│                                    │
│                                    │
│                                    │
└────────────────────────────────────┘
```

**新位置：**
```
┌────────────────────────────────────┐
│ 76px             [播]76px          │
│                                    │
│                                    │
│                                    │
└────────────────────────────────────┘
```

---

### **平板版 (768x1024):**

**原位置：**
```
┌─────────────┐
│ 16  [播]16px│
│             │
│             │
└─────────────┘
```

**新位置：**
```
┌─────────────┐
│ 76  [播]76px│
│             │
│             │
└─────────────┘
```

---

## 📐 **技術細節**

### **計算公式：**

```javascript
// 基礎邊距
const margin = 16;

// 額外安全距離
const safeOffset = 60;

// 總距離 = 基礎邊距 + 安全距離
const totalOffset = margin + safeOffset; // 76px

// X 座標（從右邊算）
const x = window.innerWidth - width - totalOffset;

// Y 座標（從上邊算）
const y = totalOffset;
```

---

### **響應式調整：**

| 螢幕寬度 | 播放器寬度 | 右邊距 | 實際 X 座標 |
|---------|----------|--------|------------|
| 1920px | 140px | 76px | 1704px |
| 1366px | 140px | 76px | 1150px |
| 768px | 140px | 76px | 552px |

---

## 🔧 **相關設定**

### **1. 拖曳邊界：**
```javascript
// 拖曳時也會保持最小 16px 的邊距
const margin = 16;
const maxX = window.innerWidth - width - margin;
const maxY = window.innerHeight - height - margin;
```

### **2. 視窗縮放調整：**
```javascript
// 當視窗縮小時，播放器會自動調整到安全位置
const safeX = Math.max(margin, Math.min(position.x, maxX));
const safeY = Math.max(margin, Math.min(position.y, maxY));
```

---

## 📋 **測試場景**

### **1. 首次載入（無儲存位置）：**
```
✅ 預設位置：右上角，距離邊緣 76px
```

### **2. 已有儲存位置：**
```
✅ 使用儲存的位置
✅ 如果儲存的位置超出範圍，調整到安全位置
```

### **3. 視窗縮放：**
```
✅ 自動調整到視窗範圍內
✅ 保持至少 16px 的邊距
```

### **4. 拖曳：**
```
✅ 可以拖曳到任何位置
✅ 鬆開時確保不超出邊界
```

---

## 🎯 **距離設定理由**

### **為什麼選擇 60px？**

1. **視覺舒適度** - 不會太靠邊，視覺上更舒適
2. **防遮擋** - 避免被瀏覽器工具列或滾動條遮擋
3. **拖曳空間** - 提供更充裕的拖曳操作空間
4. **響應式考量** - 在小螢幕上也不會太擁擠

### **為什麼不是更大或更小？**

- **40px** - 太小，改善不明顯
- **60px** - ✅ 適中，效果明顯
- **80px** - 太大，浪費螢幕空間
- **100px** - 太大，小螢幕上會有問題

---

## 🔄 **如何重置位置**

### **方法 1：清除 localStorage**
```javascript
localStorage.removeItem('miniPlayerPosition');
// 重新整理頁面，播放器會回到新的預設位置
```

### **方法 2：開發者工具**
```javascript
// 在 Console 中執行
localStorage.removeItem('miniPlayerPosition');
location.reload();
```

---

## ✅ **完成效果**

### **Before:**
```
距離右邊：16px  ❌ 太靠邊
距離上邊：16px  ❌ 太靠邊
```

### **After:**
```
距離右邊：76px  ✅ 舒適
距離上邊：76px  ✅ 舒適
```

---

## 🎊 **總結**

**改進內容：**
- ✅ 增加 60px 的安全距離
- ✅ 總距離從 16px 增加到 76px
- ✅ 視覺上更舒適
- ✅ 避免內容被切掉
- ✅ 保持響應式設計

**使用者體驗：**
- ✅ 播放器不會太靠邊
- ✅ 拖曳操作更方便
- ✅ 不會被瀏覽器 UI 遮擋
- ✅ 適用於各種螢幕尺寸

---

**清除舊的 localStorage 位置後重新整理，就會看到新的預設位置了！** 🎉✨

**提示：** 如果播放器還在舊位置，請清除瀏覽器的 localStorage 或手動拖曳到新位置後釋放，新位置會自動儲存。


