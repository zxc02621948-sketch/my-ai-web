# 檢舉按鈕顯示問題排查

## 🔍 為什麼看不到檢舉按鈕？

### **檢舉按鈕的顯示條件：**

```jsx
{currentUser && currentUser?._id !== comment?.userId && onReport && (
  <button>檢舉</button>
)}
```

**必須滿足 3 個條件：**

1. ✅ `currentUser` - **你必須已登入**
2. ✅ `currentUser?._id !== comment?.userId` - **不是你自己的留言**
3. ✅ `onReport` - **組件有傳遞 `onReport` 函數**

---

## 🎯 排查步驟

### **Step 1: 確認你已登入**

**檢查方式：**
- 右上角是否顯示你的頭像？
- 是否可以發送留言？

**如果未登入：**
```
❌ 檢舉按鈕不會顯示
✅ 請先登入
```

---

### **Step 2: 確認不是你自己的留言**

**檢查方式：**
- 查看留言的用戶名，是否和你的一樣？
- 這條留言是否有「刪除」按鈕？（如有，表示是你的留言）

**如果是你自己的留言：**
```
❌ 檢舉按鈕不會顯示（不能檢舉自己）
✅ 查看別人的留言試試
```

---

### **Step 3: 檢查別人的留言**

**應該看到：**
```
┌────────────────────────────────────┐
│  好看！                             │
│  🕒 3 分鐘前  回覆  🚩 檢舉       │
└────────────────────────────────────┘
```

**如果還是看不到：**
1. 重新整理頁面（Ctrl+F5 強制刷新）
2. 清除瀏覽器快取
3. 檢查瀏覽器 Console 是否有錯誤

---

## 🔧 開發者排查

### **檢查 Console 是否有錯誤：**

**按 F12 打開開發者工具 → Console 標籤**

**可能的錯誤：**
```javascript
// 1. onReport 未定義
onReport is not a function

// 2. currentUser 未定義
Cannot read property '_id' of null

// 3. 組件導入錯誤
Flag is not defined
```

---

### **檢查組件是否正確導入：**

**CommentItem.jsx:**
```jsx
import { Trash2, Flag } from "lucide-react"; // ✅ Flag 要導入
```

**CommentBox.jsx:**
```jsx
import ReportModal from "@/components/common/ReportModal"; // ✅ 導入
import NotificationModal from "@/components/common/NotificationModal"; // ✅ 導入
```

---

### **檢查 props 是否正確傳遞：**

**CommentBox.jsx:**
```jsx
<CommentItem
  // ... 其他 props
  onReport={handleReport}  // ✅ 必須傳遞
/>
```

**CommentItem.jsx（遞迴傳遞給回覆）:**
```jsx
<CommentItem
  // ... 其他 props
  onReport={onReport}  // ✅ 回覆也要傳遞
/>
```

---

## 🎨 視覺示例

### **正確的顯示：**

**主留言（別人的）：**
```
┌────────────────────────────────────────┐
│  👤 張三                                │
│  這張圖片超讚！                          │
│  🕒 3 分鐘前   回覆   🚩 檢舉          │
└────────────────────────────────────────┘
```

**回覆（別人的）：**
```
  ┌────────────────────────────────────┐
  │  👤 李四                            │
  │  @張三 我也覺得！                    │
  │  🕒 2 分鐘前   🚩 檢舉             │
  └────────────────────────────────────┘
```

**自己的留言：**
```
┌────────────────────────────────────────┐
│  👤 你                                  │
│  好看！                                 │
│  🕒 剛剛   回覆   🗑️（刪除按鈕）      │
│  ❌ 沒有檢舉按鈕（不能檢舉自己）         │
└────────────────────────────────────────┘
```

---

## ✅ 快速測試

### **測試步驟：**

1. **登入你的帳號**
2. **找一張別人的圖片**
3. **找到別人的留言**（不是你自己發的）
4. **應該看到「🚩 檢舉」按鈕**

### **如果還是看不到：**

1. **重新整理頁面** (Ctrl+F5)
2. **清除快取** (Ctrl+Shift+Delete)
3. **檢查 Console 錯誤** (F12)
4. **重啟開發伺服器** (npm run dev)

---

## 🎯 最可能的原因

| 原因 | 佔比 | 解決方法 |
|-----|------|---------|
| 未登入 | 40% | 登入帳號 |
| 查看自己的留言 | 30% | 查看別人的留言 |
| 快取問題 | 20% | Ctrl+F5 強制刷新 |
| 開發伺服器未更新 | 10% | 重啟開發伺服器 |

---

**試試看，應該就能看到檢舉按鈕了！** 🚩✨

