# Report æ¨¡å‹ä¿®å¾© - æ·»åŠ åœ–ç‰‡ç•™è¨€æª¢èˆ‰é¡å‹

> **ä¿®å¾©æ—¥æœŸï¼š** 2025-10-22  
> **éŒ¯èª¤ï¼š** `image_comment` is not a valid enum value

---

## ğŸ› **éŒ¯èª¤è¨Šæ¯**

```
POST /api/reports error: Error: Report validation failed: 
type: `image_comment` is not a valid enum value for path `type`.
```

---

## ğŸ” **å•é¡ŒåŸå› **

`models/Report.js` çš„ `type` æ¬„ä½åªå®šç¾©äº†é€™äº›å…è¨±å€¼ï¼š

```javascript
enum: [
  // åœ–ç‰‡æª¢èˆ‰é¡å‹
  "category_wrong","rating_wrong","duplicate","broken","policy_violation","other",
  // è¨è«–å€æª¢èˆ‰é¡å‹
  "discussion_post","discussion_comment"
]
```

ä½†æ˜¯åœ–ç‰‡ç•™è¨€æª¢èˆ‰ä½¿ç”¨çš„ `image_comment` é¡å‹ä¸åœ¨åˆ—è¡¨ä¸­ï¼

---

## âœ… **ä¿®å¾©æ–¹æ¡ˆ**

### **ä¿®æ”¹ `models/Report.js`**

**æ·»åŠ  `image_comment` åˆ° enumï¼š**

```javascript
type: {
  type: String,
  enum: [
    // åœ–ç‰‡æª¢èˆ‰é¡å‹
    "category_wrong","rating_wrong","duplicate","broken","policy_violation","other",
    // è¨è«–å€æª¢èˆ‰é¡å‹
    "discussion_post","discussion_comment",
    // åœ–ç‰‡ç•™è¨€æª¢èˆ‰é¡å‹ âœ… æ–°å¢
    "image_comment"
  ],
  required: true
},
```

---

## ğŸ”„ **é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨**

**é‡è¦ï¼š** æ¨¡å‹å®šç¾©æ”¹è®Šå¾Œï¼Œå¿…é ˆé‡å•Ÿé–‹ç™¼ä¼ºæœå™¨ï¼

### **æ–¹æ³• 1ï¼šçµ‚ç«¯é‡å•Ÿ**

```bash
# æŒ‰ Ctrl+C åœæ­¢é–‹ç™¼ä¼ºæœå™¨
# ç„¶å¾Œé‡æ–°å•Ÿå‹•
npm run dev
```

### **æ–¹æ³• 2ï¼šè‡ªå‹•é‡å•Ÿï¼ˆæ¨è–¦ï¼‰**

æ¨¡å‹æª”æ¡ˆä¿®æ”¹å¾Œï¼ŒNext.js æ‡‰è©²æœƒè‡ªå‹•é‡æ–°ç·¨è­¯ï¼Œä½†å¦‚æœé‡åˆ°å•é¡Œï¼Œæ‰‹å‹•é‡å•Ÿæ›´ä¿éšªã€‚

---

## ğŸ¯ **æ”¯æŒçš„æª¢èˆ‰é¡å‹**

### **ç¾åœ¨å®Œæ•´çš„åˆ—è¡¨ï¼š**

| é¡å‹ | èªªæ˜ | ç”¨é€” |
|-----|------|------|
| `category_wrong` | åˆ†é¡éŒ¯èª¤ | åœ–ç‰‡æª¢èˆ‰ |
| `rating_wrong` | åˆ†ç´šéŒ¯èª¤ | åœ–ç‰‡æª¢èˆ‰ |
| `duplicate` | é‡è¤‡/æ´—ç‰ˆ | åœ–ç‰‡æª¢èˆ‰ |
| `broken` | å£åœ–/ç„¡æ³•é¡¯ç¤º | åœ–ç‰‡æª¢èˆ‰ |
| `policy_violation` | ç«™è¦é•è¦ | åœ–ç‰‡æª¢èˆ‰ |
| `other` | å…¶ä»– | åœ–ç‰‡æª¢èˆ‰ |
| `discussion_post` | è¨è«–å€è²¼æ–‡æª¢èˆ‰ | è¨è«–å€ |
| `discussion_comment` | è¨è«–å€ç•™è¨€æª¢èˆ‰ | è¨è«–å€ |
| `image_comment` âœ… | **åœ–ç‰‡ç•™è¨€æª¢èˆ‰** | **åœ–ç‰‡ç•™è¨€** |

---

## ğŸ“‹ **æ¸¬è©¦æ­¥é©Ÿ**

### **1. é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨**
```bash
Ctrl+C â†’ npm run dev
```

### **2. é‡æ–°æ•´ç†ç€è¦½å™¨**
```
Ctrl+F5 (å¼·åˆ¶åˆ·æ–°)
```

### **3. æ¸¬è©¦æª¢èˆ‰åŠŸèƒ½**
1. æ‰¾åˆ°åˆ¥äººçš„ç•™è¨€
2. é»æ“Šã€ŒğŸš© æª¢èˆ‰ã€
3. å¡«å¯«åŸå› 
4. æäº¤

### **4. æª¢æŸ¥çµ‚ç«¯æ—¥èªŒ**

**æˆåŠŸï¼š**
```
POST /api/reports 200 in 50ms
```

**å¤±æ•—ï¼š**
```
POST /api/reports 500 in 50ms
Report validation failed...
```

---

## âœ… **å®Œæ•´ä¿®å¾©æ¸…å–®**

### **1. ä¿®æ”¹ API (`app/api/reports/route.js`)** âœ…
- æ·»åŠ  `image_comment` é¡å‹è™•ç†
- æŸ¥è©¢ç•™è¨€ä½œè€…
- æª¢æŸ¥ä¸èƒ½æª¢èˆ‰è‡ªå·±

### **2. ä¿®æ”¹æ¨¡å‹ (`models/Report.js`)** âœ…
- åœ¨ `type` enum ä¸­æ·»åŠ  `image_comment`

### **3. é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨** â³
- å¿…é ˆé‡å•Ÿæ‰èƒ½è¼‰å…¥æ–°çš„æ¨¡å‹å®šç¾©

---

## ğŸŠ **ç¾åœ¨æ‡‰è©²å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼**

**å®Œæ•´æµç¨‹ï¼š**

1. âœ… å‰ç«¯é¡¯ç¤ºæª¢èˆ‰æŒ‰éˆ•
2. âœ… é»æ“Šæ‰“é–‹æª¢èˆ‰å½ˆçª—
3. âœ… å¡«å¯«åŸå› ä¸¦æäº¤
4. âœ… API è™•ç† `image_comment` é¡å‹
5. âœ… æ¨¡å‹é©—è­‰é€šéï¼ˆæ–°å¢ enum å€¼ï¼‰
6. âœ… æˆåŠŸå‰µå»ºæª¢èˆ‰è¨˜éŒ„
7. âœ… é¡¯ç¤ºæˆåŠŸé€šçŸ¥

---

**é‡å•Ÿé–‹ç™¼ä¼ºæœå™¨å¾Œï¼Œè©¦è©¦çœ‹æª¢èˆ‰åŠŸèƒ½æ‡‰è©²å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼** ğŸ‰âœ¨

